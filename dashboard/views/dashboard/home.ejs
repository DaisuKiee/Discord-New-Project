<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/layout-head') %>
    <title>Dashboard - Select Server</title>
</head>
<body>
    <%- include('../partials/loading', { loadingText: 'Loading your servers...' }) %>
    
    <div class="page-wrapper">
        <%- include('../partials/dashboard-nav', { user }) %>
        
        <main style="padding-top: 100px; min-height: 100vh;">
            <div style="max-width: 1200px; margin: 0 auto; padding: 0 1.5rem;">
                <!-- Welcome Header -->
                <div class="slide-up" style="text-align: center; margin-bottom: 3rem;">
                    <div style="width: 80px; height: 80px; border-radius: 20px; background: linear-gradient(135deg, var(--primary), var(--accent)); display: flex; align-items: center; justify-content: center; font-size: 2rem; margin: 0 auto 1.5rem;">
                        <i class="fas fa-server"></i>
                    </div>
                    <h1 style="font-size: 2.5rem; font-weight: 700; margin-bottom: 0.75rem;">
                        Welcome back, <span class="gradient-text"><%= user.username %></span>!
                    </h1>
                    <p style="color: var(--text-muted); font-size: 1.1rem; max-width: 500px; margin: 0 auto;">
                        Select a server below to manage its settings, modules, and features.
                    </p>
                </div>

                <!-- Quick Tips -->
                <div class="slide-up" style="animation-delay: 0.1s; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(192, 132, 252, 0.05)); border: 1px solid var(--border); border-radius: 16px; padding: 1.25rem 1.5rem; margin-bottom: 2rem; display: flex; align-items: center; gap: 1rem;">
                    <div style="width: 40px; height: 40px; border-radius: 10px; background: rgba(139, 92, 246, 0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <i class="fas fa-lightbulb" style="color: var(--primary-light);"></i>
                    </div>
                    <div>
                        <strong style="color: var(--primary-light);">Quick Tip:</strong>
                        <span style="color: var(--text-muted);"> You can only manage servers where you have Administrator or Manage Server permissions.</span>
                    </div>
                </div>

                <!-- Server Grid -->
                <div class="grid-3 stagger">
                    <% if (guilds && guilds.length > 0) { %>
                        <% guilds.forEach((guild, index) => { %>
                            <a href="/dashboard/guild/<%= guild.id %>" class="card card-clickable server-card">
                                <% if (guild.icon) { %>
                                    <img src="https://cdn.discordapp.com/icons/<%= guild.id %>/<%= guild.icon %>.png" 
                                         class="server-icon" alt="<%= guild.name %>">
                                <% } else { %>
                                    <div class="server-icon-placeholder">
                                        <%= guild.name.charAt(0) %>
                                    </div>
                                <% } %>
                                <div class="server-info">
                                    <h3><%= guild.name %></h3>
                                    <p><i class="fas fa-cog"></i> Manage Server</p>
                                </div>
                            </a>
                        <% }); %>
                    <% } else { %>
                        <div class="empty-state" style="grid-column: 1 / -1;">
                            <i class="fas fa-server"></i>
                            <h3>No Servers Found</h3>
                            <p>You don't have permission to manage any servers, or the bot isn't in any of your servers.</p>
                            <a href="/invite" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Invite Bot
                            </a>
                        </div>
                    <% } %>
                </div>

                <!-- Help Section -->
                <div class="slide-up" style="animation-delay: 0.4s; margin-top: 3rem; text-align: center; padding: 2rem; border-top: 1px solid var(--border);">
                    <h3 style="font-size: 1.25rem; margin-bottom: 0.5rem;">Need Help?</h3>
                    <p style="color: var(--text-muted); margin-bottom: 1rem;">Check out our documentation or join our support server.</p>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <a href="/docs" class="btn btn-secondary">
                            <i class="fas fa-book"></i> Documentation
                        </a>
                        <a href="/support" class="btn btn-secondary">
                            <i class="fab fa-discord"></i> Support Server
                        </a>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/js/dashboard.js"></script>
</body>
</html>
